% function test_PCA_of_optimized_filters

    clear
    clc
    
    %%
    
    Filters.lambda = 400 : 25 : 700;
    
    Filters.T = [
0.460000000000000	0.320350961843314	0.222710308838152	0.200735380013615	0.100000000000000	0.0444771734555104	0.0462273993853216	0.0493575788495335	0.160000000000000	0.156300456367174	0.0961525361889829	0.0750025329241397	0.0900000000000000
0.316000000000000	0.450755715379672	0.403473897538464	0.250927477984087	0.145800000000000	0.0807438169178750	0.0578450533344238	0.0455862762882104	0.0340000000000000	0.0176791187729653	0.0135168816377918	0.0255899208235729	0.130500000000000
0.166500000000000	0.315873767664214	0.488790792976346	0.426831309798120	0.234500000000000	0.0807009990857660	0.0172724489746266	0.00261335646656279	0.00120000000000000	0.000579103701977141	0.00432337502083203	0.0597715034927309	0.182400000000000
0.121500000000000	0.188367138656080	0.365154026527656	0.499975490251908	0.422100000000000	0.232841136027933	0.0771408501041912	0.0154511087013787	0.00480000000000000	0.00232879465984511	0.00453772180267279	0.0223542710795854	0.112800000000000
0.0201000000000000	0.000422885294302202	0	0.280337688952390	0.646800000000000	0.535560945491133	0.276187645993043	0.0955419483159386	0.0418000000000000	0.0248200265137588	0.0309513249638789	0.0192767303336679	0.0364000000000000
0.120600000000000	0.0707878555193221	0.0636029040643152	0.107970216738190	0.319200000000000	0.491264709088847	0.392244627583226	0.219556795434863	0.125400000000000	0.0730924858389650	0.0578014582148967	0.0427168914403150	0.0624000000000000
0.0360000000000000	0.00291566103380433	0.00106295387483474	0.00921665304897480	0.0608000000000000	0.221505806693461	0.460394147251121	0.401753520916590	0.280500000000000	0.169718762734405	0.117863507245821	0.0987906594879114	0.103200000000000
0.00240000000000000	0.000326637135126666	0.000524263457937391	0.0585892398861718	0.203500000000000	0.352865598288122	0.434127502228259	0.385294744886707	0.264000000000000	0.140810379789449	0.0854919793720630	0.0633475978245070	0.0792000000000000
0.107300000000000	0.0169272940914640	0.00926855823703647	0.0973170834262020	0.103600000000000	0.0679536597011704	0.0757983792459257	0.172477531431928	0.372400000000000	0.303320325699917	0.240690200083222	0.197609030192729	0.228000000000000
0.227200000000000	0.160600387662478	0.0571153018869833	0.0198707472365497	0.00790000000000000	0.00760577811967825	0.0122311805057009	0.0758984460912643	0.408000000000000	0.521722843524330	0.445831864901665	0.420429418445324	0.453900000000000
0.122500000000000	0.0697275058965339	0.00828169845534866	0.000258637013273007	0	0	3.42929116494692e-05	0.000249177041432730	0.0529000000000000	0.474828292582892	0.693874513065056	0.738286507348678	0.739600000000000
0.00980000000000000	0.00975728030855346	0.0173583875897472	0.0162058382891288	0.0111000000000000	0.00556926470704296	0.00354763216059201	0.00548522394513616	0.0264000000000000	0.132327392851277	0.403115762624291	0.647700351536083	0.730400000000000
0.0792000000000000	0.0426001801696429	0.0404046766090296	0.106334523552181	0.116000000000000	0.115376068983750	0.102987608162816	0.0867310105494164	0.0672000000000000	0.0649653155837434	0.0832928657233593	0.441604281408669	0.694200000000000
                ];
    
    [Camera.lambda, Camera.RGB_sen] = camera_RGB_spectral_sensitivity('Canon 600D');
    
    %%
    
    
    Filters.qty = size(Filters.T, 2);
    qty_f = Filters.qty;
    qty_w = length(Filters.lambda);
    
    Filters.T(Filters.T<0) = 0;
    Filters.T(Filters.T>1) = 1;
    
    Sen = zeros(3, length(Filters.lambda));
    for cc = 1 : 3
        Sen(cc,:) = interp1(Camera.lambda, Camera.RGB_sen(cc,:), Filters.lambda);
    end
    Camera.RGB_sen = Sen;
    Camera.lambda = Filters.lambda;
    
    %%
    
    S = repmat(Camera.RGB_sen, [Filters.qty, 1, 1]);
    i = ceil((1 : qty_f*3)./3);
    T = Filters.T(:,i)';
    
    ST = S .* T;
    
    [coeff,score,latent,tsquared,explained,mu] = pca(ST);

% end



















































