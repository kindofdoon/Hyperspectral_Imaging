% function test_pyranometer_data

    %%
    
    clear
    clc
    
    %%
    
%     % Source: Toward the development of a diffuse horizontal shortwave irradiance working standard, Michalsky, 2005
%     XY = [0.298225057785526,0.300338151200075,0.300868759869846,0.301400305968177,0.301932791151226,0.302466217078078,0.303000585410749,0.303535897814193,0.304161624377411,0.304609361507916,0.305147516142829,0.305686621537790,0.306226679372510,0.306767691329669,0.307309659094919,0.307852584356889,0.308396468807195,0.308941314140436,0.309578183743423,0.310125116817393,0.310033894249113,0.310033894249113,0.310673016160316,0.310673016160316,0.310307642484244,0.311221883479302,0.311221883479302,0.310855864296026,0.311771720484480,0.311771720484480,0.311405054653580,0.312322528888998,0.312230659957164,0.312230659957164,0.312874310409032,0.312782279171971,0.312782279171971,0.313427066763789,0.313334872934755,0.313334872934755,0.313980799675512,0.313888442967255,0.313888442967255,0.314535510869491,0.314442990994250,0.314165594623523,0.315091202074059,0.314720632295510,0.315694308801907,0.315276650554877,0.316252047259637,0.316764173080492,0.317370481992542,0.316950606196646,0.317931181752468,0.318446026696054,0.319055554794245,0.318633449675448,0.319572220502225,0.320325228181092,0.321458067838979,0.322405160670653,0.323450185971541,0.324498598556544,0.325263214254714,0.325167538850941,0.325167538850941,0.325167538850941,0.324880681462674,0.324880681462674,0.325837858137788,0.325742013703879,0.325742013703879,0.325742013703879,0.325454649523463,0.325454649523463,0.326413517246619,0.326317503483947,0.326317503483947,0.326317503483947,0.326029631616029,0.326029631616029,0.326990193374808,0.326894009984219,0.326894009984219,0.326894009984219,0.326605629531866,0.326605629531866,0.327567888319128,0.327471535000940,0.327471535000940,0.327471535000940,0.327182645065634,0.327182645065634,0.328146603879526,0.328050080333527,0.328050080333527,0.328050080333527,0.327760680015163,0.327760680015163,0.328726341859129,0.328629647784577,0.328629647784577,0.328629647784577,0.328339736181458,0.328339736181458,0.329916622129858,0.330083050038765,0.330083050038765,0.330374500922268,0.330812159831280,0.330374500922268,0.329791856268378,0.329791856268378,0.330083050038765,0.332128618325958,0.332715391347163,0.332617523903156,0.333303201022722,0.333205160675893,0.334777272601352,0.335072868306327,0.335250350994500,0.334777272601352,0.334777272601352,0.337546337780202,0.337149359156813,0.339178843013730,0.339538253288795,0.339658141326891,0.341140245695102,0.341541923412827,0.341944074088495,0.342145326959559,0.342548188116510,0.342850645246791,0.342850645246791,0.343456360917869,0.343456360917869,0.345279936219268,0.345279936219268,0.344823136686063,0.347726440093954,0.348956184949428,0.350087271193255,0.350808961466490,0.351428737128169,0.352049607750106,0.352671575266771,0.353398592974810,0.355573706656391,0.358635346194372,0.359903670719404,0.360221452086230,0.360221452086230,0.360857856834513,0.360857856834513,0.361389052910514,0.361814572713046,0.362134041334258,0.362134041334258,0.363735620606067,0.363735620606067,0.364378233850594,0.364699966087898,0.364699966087898,0.364378233850594,0.364699966087898,0.366097425010937,0.366744210865199,0.366744210865199,0.366312893455796,0.366312893455796,0.367392139398740,0.367284071871460,0.367284071871460,0.369467001920177,0.368745669403491,0.369234159970781,0.369342801280632,0.369560179807699,0.369560179807699,0.369690668329939,0.369560179807699,0.369560179807699,0.369886487507836,0.371194602027397,0.371194602027397,0.371194602027397,0.371085416014744,0.371522352860709,0.371522352860709,0.371850393085645,0.371850393085645,0.371850393085645,0.371741014173607,0.372178722957728,0.372178722957728,0.372507342732703,0.372507342732703,0.372507342732703,0.372397770580483,0.372836252666546,0.372836252666546,0.373165453015455,0.373165453015455,0.373165453015455,0.373055687281654,0.373494944035855,0.373494944035855,0.373824725984400,0.373824725984400,0.374815819968814,0.374485163693660,0.375975417785671,0.375146768200988,0.375345477386891,0.374815819968814,0.374815819968814,0.374650455352712,0.374815819968814,0.377916058606559,0.377471602305570,0.377471602305570,0.378583724490301,0.378138482966503,0.379252569942156,0.378806541808293,0.380481857122894,0.383177786541474,0.385325604643345,0.384872434186531,0.386006361003107,0.386688320057981,0.387371483932773,0.388055854756045,0.389485513114526,0.389932643637704,0.394153884381762,0.394501907395442,0.395664204957572,0.395547821269197,0.395198875567713,0.395198875567713,0.396363226565815,0.396246637261890,0.395897075076574,0.395897075076574,0.397063483138461,0.396946687855724,0.396596508097431,0.396596508097431,0.397764976857327,0.397647975231875,0.397297176809536,0.397297176809536,0.398467709908084,0.398350501575371,0.397999083395990,0.397999083395990,0.399171684480266,0.399054269075101,0.398702230043750,0.398702230043750,0.401173040458628,0.399406618943638,0.404372309145981,0.405325131182357,0.406041220789429,0.406758575515009,0.407477197594187,0.409916240286114,0.409544291656940,0.409881786411899,0.412058046301792,0.412786030978207,0.414636020186339,0.414855646191416,0.417058314699342,0.417795133370880,0.418533253783052,0.419396042587830,0.421498798894874,0.423362925605843,0.429762842413896,0.430902241009640,0.431663517803780,0.432426139548821,0.433190108620893,0.434210834007125,0.435490123623615,0.434722098271650,0.436644706538533,0.437802350514161,0.442854378416646,0.443636771102007,0.444551309758219,0.445992252469166,0.449548944729680,0.449548944729680,0.452201805728758,0.453267328356402,0.454602762991484,0.455942132138393,0.457958588435311,0.459578172548605,0.460796618334880,0.462154236070277,0.463515853674255,0.464881482931388,0.466113988994184,0.466937474530982,0.467762414923127,0.469623863441013,0.471825738379476,0.475252772544628,0.476793229188043,0.478479422566263,0.479465787891778,0.480312862107616,0.481019900357642,0.481869720230483,0.482721041483653,0.483573866769647,0.486284432833547,0.489874128729589,0.491317415808558,0.492764955158612,0.494216759307963,0.495381281725460,0.496548548105874,0.497572162178261,0.498451225001394,0.499772732050780,0.502426266281577,0.504648303985416,0.505986240894239,0.507476998133273,0.508972147501906,0.510171438024707,0.511373554434475,0.512578503389843,0.513786291565137,0.515451648511713,0.519012294031066,0.520939741706612,0.525557762375906,0.529748972459819,0.532091847960911,0.533973606542434,0.535389291467733,0.536966677170052,0.538548710230273,0.541567425586954,0.545886309290578,0.548784682721002,0.552185573931075,0.554954106726660,0.556098121416344,0.557080582296814,0.558064778895037,0.560038391516159,0.563509023447006,0.565834718726203,0.567501803984385,0.571018687668715,0.577098411699093,0.582728340342974,0.585477740056047,0.586512106031832,0.587548299426320,0.588586323468018,0.591537361337321,0.596781214978370,0.602071554273252,0.606872945386000,0.610095126251527,0.613875966383380,0.618225625233468,0.621508082946159,0.623706064691326,0.626464476193404,0.631460395610454,0.638183651826636,0.643273029148041,0.646117977791369,0.647830982834908,0.652997295545531,0.659949858456753,0.666976446377518,0.673483187210852,0.678854070732433,0.683061019130901,0.685073481282385,0.686687719188244,0.687294038544614,0.690681917039547,0.698299792695835,0.705734698280788,0.711990887169395,0.715139748409850,0.715560647435410,0.716824831428549,0.720206918499675,0.720206918499675,0.727875072631589,0.731094183501414,0.732601303595365,0.737575178864811,0.745428255543374,0.752700339130446,0.754473926128593,0.756029242584517,0.756029242584517,0.755362286175683,0.756696787890705,0.757364922614220,0.757364922614220,0.758702962395426,0.760714455722967,0.760714455722967,0.763404744928921,0.764753455289510,0.767006603018456,0.766780989843576,0.766104548422342,0.766104548422342,0.768361676796819,0.767458028537071,0.772214067372578,0.779747462039718,0.784579660118899,0.788049553521074,0.794334079165618,0.802791476609067,0.809193565918590,0.812772317138113,0.817809174609135,0.823022508770512,0.831638547095903,0.840493130962519,0.847195882854195,0.854706095235274,0.853952087750143,0.863044247325310,0.872233212525670,0.881520014055645,0.888549946513266,0.892479660414391,0.895372491979869,0.900050799402518,0.906504361608445,0.911585570764281,0.921291362921362,0.927000727261746,0.929731894501220,0.934668289084813,0.934393358622245,0.942676558190073,0.945509540624104,0.954396543605845,0.961158983576976,0.969679454751041,0.973108754865856,0.981735158235888,0.990438032847937,1.00098337932949,1.01164100374133,1.02241210152392,1.03329788084571,1.04429956273876,1.05541838123561,1.06665558350774,1.07801243000547,1.08852906449122,1.09914829482637,1.10889201206993,1.11445174424534,1.11773518729381,1.12664888493753,1.13763999615933,1.14246965902662,1.15280087916362,1.15994493857409,1.16919524990306,1.18164385204262,1.19422499636898,1.20694009407926,1.21979057139579,1.23277786972611,1.24590344582467,1.25916877195617,1.27257533606079,1.28612464192099,1.29981820933027,1.31365757426358,1.32530287091622,1.33705140066156,1.34652516698633,1.41799809413872,1.43233705272139,1.44758736621741,1.46300005215312,1.47857683933295,1.49168411040198,1.50490757465780,1.52093055769273,1.53712413989911,1.55349013767262,1.57003038674840,1.58674674240693,1.60364107968216,1.62071529357182,1.63797129924995,1.65541103228176,1.67303644884073,1.69084952592800,1.70885226159416,1.72704667516335,1.74543480745976,1.76401872103656,1.78280050040723,1.80019274997870,1.95177146138740,1.97150799718624,1.99249894687917,2.01371339045071,2.03515370747466,2.05682230286050,2.07872160712316,2.10085407665562,2.12322219400447,2.14582846814836,2.16867543477940,2.19176565658764,2.21510172354845,2.23868625321310,2.26252189100230,2.28661131050299,2.31095721376818,2.33556233162008,2.36042942395635,2.38556128005974,2.41096071891092,2.43663058950465,2.46257377116942,2.48440396699527;0.00705302985813394,0.0204677970083140,0.0278975141991829,0.0356368029396712,0.0443048063290183,0.0529728097183655,0.0616408131077124,0.0703088164970595,0.0785640578202471,0.0882639663749927,0.0963128266651007,0.104980830054448,0.113648833443795,0.122316836833142,0.130675268672869,0.138724128962977,0.147082560802705,0.155750564192052,0.164005805515239,0.189390672584042,0.179897145062376,0.173705714069985,0.217458493082880,0.205901155230417,0.200948010436504,0.245939075647877,0.234381737795414,0.229428593001502,0.274419658212875,0.262862320360412,0.257909175566499,0.302900240777872,0.293200332223126,0.286699329681116,0.331380823342869,0.321680914788124,0.315179912246114,0.359861405907867,0.350161497353121,0.343660494811111,0.388341988472864,0.378642079918119,0.372141077376108,0.414345998640905,0.405265233185399,0.400312088391486,0.430856481287281,0.425077812361049,0.447212178158846,0.439937246742787,0.460833326342106,0.473164593068617,0.489313908907103,0.482038977491044,0.502935057090363,0.515266323816875,0.531415639655360,0.524140708239301,0.543540525348792,0.555562220525684,0.566397224762368,0.576148728575384,0.585590660838780,0.595961307751034,0.642190659160885,0.633109893705379,0.625680176514510,0.619179173972499,0.613297314529728,0.605867597338859,0.688420010570736,0.679545626148309,0.672115908957440,0.665614906415430,0.660352190071898,0.652922472881029,0.734236599914427,0.725362215492001,0.717932498301132,0.711431495759122,0.706168779415589,0.698739062224721,0.780053189258119,0.771178804835692,0.763749087644823,0.757248085102813,0.751985368759281,0.744555651568412,0.825869778601810,0.816995394179384,0.809565676988515,0.803064674446505,0.797801958102972,0.790372240912104,0.871686367945502,0.862811983523075,0.855382266332206,0.848881263790196,0.843618547446664,0.836188830255795,0.917502957289194,0.908628572866767,0.901198855675898,0.894697853133888,0.889435136790356,0.882005419599487,0.966120432081824,0.956302591508176,0.949182445866926,0.940514442477579,0.932156010637852,0.924726293446983,0.992212891264042,0.984783174073173,0.977353456882304,0.912033859912582,0.898722283278942,0.890260660922674,0.878290561004052,0.869828938647785,0.858890743894561,0.849913168955595,0.838789231272599,0.829130598924470,0.823186825171774,0.871479986912422,0.860954554225358,0.883367534417813,0.893680689470852,0.905037542891180,0.874369321375538,0.860954554225358,0.854763123232967,0.844856833645142,0.838665402652751,0.830616542362643,0.823496396721394,0.813899678683188,0.806779533041939,0.795222195189476,0.786812168091479,0.779382450900610,0.805541246843461,0.817924108828242,0.829584637197245,0.839284545751990,0.846714262942859,0.854143980133728,0.861264125774978,0.870448081747024,0.879971092273415,0.871479986912422,0.865907699019271,0.857858838729163,0.850738693087913,0.841141975049708,0.834021829408458,0.822567682072535,0.816376251080145,0.808327390790037,0.801207245148787,0.792023289176741,0.784799953018952,0.773242615166489,0.764058659194443,0.757248085102813,0.749715177395404,0.741459936072217,0.801104054632247,0.829171875131086,0.817614537278623,0.812661392484710,0.787895668515147,0.856826933563764,0.847333406042098,0.841141975049708,0.883862848897204,0.873646987759759,0.867765128316988,0.911621097846422,0.902127570324756,0.895316996233127,0.938966584729482,0.929060295141656,0.921630577950787,0.950111160515785,0.858477981828402,0.851048264637533,0.843618547446664,0.834537781991158,0.827520826866448,0.820091109675579,0.811423106286232,0.803993389095363,0.796563671904494,0.787482906448988,0.780465951324278,0.773036234133409,0.764368230744062,0.756938513553193,0.749508796362325,0.740428030906818,0.733411075782109,0.725981358591240,0.717313355201893,0.709883638011024,0.702453920820155,0.693373155364649,0.686356200239939,0.678926483049070,0.670258479659723,0.662828762468854,0.654986283211826,0.646421470339019,0.637908252724481,0.631871607506900,0.622460632398466,0.615773886926684,0.608344169735816,0.600140523670898,0.594723021552556,0.669020193461245,0.662828762468854,0.652612901331409,0.685117914041461,0.678926483049070,0.701215634621677,0.695024203629286,0.714217639705697,0.720409070698088,0.733823837848268,0.725981358591240,0.745793937766890,0.757351275619353,0.768495851405656,0.780465951324278,0.793313170633489,0.803250417376276,0.791816908143661,0.783355285787394,0.824631492403332,0.815757107980906,0.811423106286232,0.803993389095363,0.855588647365286,0.846714262942859,0.842380261248186,0.834950544057317,0.886545802327240,0.877671417904813,0.873337416210140,0.865907699019271,0.917502957289194,0.908628572866767,0.904294571172093,0.896864853981224,0.948460112251147,0.939585727828721,0.935251726134047,0.927822008943178,0.979417267213101,0.970542882790674,0.966208881096001,0.958779163905132,0.995205416243697,0.989736318867086,0.985195936139332,0.973019455187631,0.963732308699045,0.953826019111219,0.943300586424155,0.933836541907215,0.923488007248505,0.915851909024556,0.947015445019590,0.957540877706654,0.967694824534175,0.978385362047703,0.959398307004371,0.951659018263882,0.944229301073014,0.934426202001728,0.927357651618749,0.922868864149266,0.705549636316350,0.717932498301132,0.736506791278304,0.756938513553193,0.776751092728844,0.795325385706016,0.816685822629764,0.806469961492319,0.826592112217589,0.837427116454273,0.870860843813183,0.880767133401008,0.891086185054993,0.899960569477420,0.907018800808745,0.914613622826078,0.897896759146623,0.887784088525718,0.879528847202530,0.871067224846263,0.862192840423836,0.854143980133728,0.844547262095523,0.834744163024237,0.826901683767209,0.817150179954194,0.807089104591559,0.800588102049548,0.793467956408299,0.784180809919713,0.781085094423517,0.778918093576181,0.769940518637214,0.761272515247867,0.754771512705857,0.747341795514988,0.737745077476782,0.728664312021276,0.719170784499610,0.710090019044104,0.702041158753995,0.697913538092402,0.690483820901533,0.680629126571978,0.671084003792042,0.663447905568093,0.655192664244906,0.646111898789399,0.638682181598530,0.630839702341502,0.623409985150633,0.617012173125163,0.608034598186196,0.598231499114911,0.590389019857882,0.580689111303137,0.573053013079188,0.564797771756001,0.553859577002777,0.547668146010386,0.539247799860735,0.538690571071420,0.542302239150314,0.530951282330931,0.522283278941584,0.514234418651476,0.504947272162890,0.494009077409666,0.484309168854921,0.479562405094088,0.478117737862530,0.470894401704741,0.463774256063492,0.454590300091445,0.446747820834417,0.439318103643548,0.431888386452679,0.422291668414474,0.415997046905543,0.406503519383877,0.395668515147193,0.385246272976669,0.379570794566977,0.375917850281467,0.363989026569461,0.351399783551599,0.339016921566818,0.325602154416638,0.319204342391168,0.327098416906466,0.332928681090967,0.328491488879754,0.320649009622725,0.311619839425489,0.304809265333859,0.295986476169702,0.288247187429214,0.280198327139106,0.273490943564016,0.270292037551281,0.263275082426571,0.254813460070304,0.245990670906147,0.238302977423928,0.236445548126211,0.233865785212715,0.228190306803024,0.219986660738106,0.213330872421286,0.204250106965779,0.198471438039548,0.190422577749440,0.178747307878075,0.179587573512756,0.186810909670545,0.183612003657810,0.178658858863898,0.168752569276072,0.158227136589008,0.147577875282096,0.141716653942633,0.150797419398139,0.158227136589008,0.167307902044515,0.175253571818083,0.183405622624730,0.182126060219636,0.170609998573790,0.160703708985964,0.153273991795096,0.149559133199661,0.142748559108031,0.135318841917162,0.127889124726293,0.117363692039229,0.109727593815281,0.102917019723651,0.0966843125246440,0.0901213956727098,0.129952935057090,0.121388122184283,0.114267976543034,0.106838259352165,0.147288941835784,0.141510272909553,0.160600518469424,0.156988850390530,0.151106990947759,0.142542178074952,0.138001795347198,0.131810364354808,0.126650838527815,0.118601978237707,0.109933974848360,0.108324202790339,0.108282926583723,0.109830784331820,0.106425497286005,0.0991608849216004,0.0922883965200466,0.104464877471748,0.101059590425934,0.0974479223470389,0.0936298732350647,0.0851682508787973,0.0758811043902111,0.0679206931142802,0.0663875768685454,0.0601961458761546,0.0652524811866070,0.0550366200491623,0.0445111873620980,0.0345017072577329,0.0243890366368280,0.0337793736419541,0.0294453719472805,0.0378038037870081,0.0453883067526868,0.0540563101420337,0.0568424540886096,0.0599381695848050,0.0651492906700673,0.0639110044715890,0.0616408131077124,0.0599897648430748,0.0591642407107561,0.0580291450288178,0.0549334295326225,0.0513217614537278,0.0486388080236919,0.0435618346099314,0.0354304219065917,0.0306836581457588,0.0211901306240929,0.0122641509433963,0.00787855399045290,0.00942641173855052,0.0140906230861515,0.0169077241876894,0.0273815616164836,0.0327474684765556,0.0324378969269361,0.0321283253773166,0.0318187538276971,0.0336761831254142,0.0350176598404322,0.0341921357081134,0.0307868486622986,0.0285166572984219,0.0291358003976610,0.0264528469676251,0.0205709875248539,0.0153598664395915,0.0100455548377896,0.00344136177923948,0.00108861800213100,0.00251264713038069,0.00375093332885901,0.00529879107695663,0.00581474365965584,0.0111806505197278,0.0158242237640209,0.0183007961609771,0.0189199392602162,0.0189199392602162,0.0175784625451982,0.0172688909955787,0.0166497478963397,0.0167529384128795,0.0156178427309412,0.0152050806647819,0.0146891280820827,0.0139667944663038,0.0131412703339850,0.0121093651685864,0.0106646979370286,0.00963279277163021,0.00664026779197457,0.00257456144030455,0.000964789382283060,0.00375093332885901,0.00467964797771758,0.00261583764692075,0.00550517211003632,0.00426688591155822,0.00509241004387695,0.00560836262657616,0.00571155314311600,0.00560836262657616,0.00529879107695663,0.00509241004387695,0.00509241004387695,0.00467964797771758,0.00406050487847853,0.00406050487847853,0.00395731436193869,0.00323498074615980,0.00282221868000043,0.00282221868000043,0.00209988506422132,0.00189350403114164,0.00137755144844243,-0.000273496816195040]; % Clean
%     XY(:,1) = XY(:,1) .* 1000;    

    % Source:
    % http://www.instesre.org/Solar/PyranometerProtocol/PyranometerProtocol.htm, Diffuse
    XY = [314.068310441618,319.607258920605,319.607258920605,319.607258920605,330.685155878579,330.685155878579,325.146207399592,325.146207399592,341.763052836554,341.763052836554,347.302001315541,355.610424034022,369.457795231490,368.073058111743,374.996743710477,369.457795231490,386.074640668451,386.074640668451,386.074640668451,386.074640668451,386.074640668451,386.074640668451,391.613589147438,393.459905307101,397.152537626425,397.152537626425,397.152537626425,408.230434584400,408.230434584400,415.615699223049,419.308331542374,431.770965620095,430.386228500348,430.386228500348,427.616754260855,427.616754260855,426.693596181024,430.386228500348,448.387811057057,441.464125458323,447.003073937310,460.850445134778,469.158867853259,483.006239050727,485.775713290220,485.775713290220,491.314661769207,485.775713290220,499.623084487688,507.931507206169,520.117193859941,519.009404164143,532.856775361611,537.010986720851,549.473620798573,560.551517756547,574.398888954015,591.015734390976,585.476785911989,607.632579827938,624.249425264899,640.866270701861,656.098379019075,674.099961575784,690.716807012745,685.177858533758,707.333652449707,718.411549407681,735.028394844642,751.645240281604,760.876821079916,759.953663000085,757.184188760591,773.801034197553,790.417879634514,804.265250831982,818.112622029450,834.729467466411,851.346312903373,867.963158340334,884.580003777296,901.196849214257,917.813694651219,933.045802968434,951.047385525142,967.664230962103,984.281076399065,1000.89792183603,1017.51476727299,1034.13161270995,1050.74845814691,1067.36530358387,1083.98214902083,1100.59899445780,1117.21583989476,1133.83268533172,1150.44953076868,1167.06637620564,1183.68322164260,1200.30006707956,1216.91691251653,1233.53375795349,1250.15060339045,1266.76744882741,1283.38429426437,1300.00113970133,1316.61798513829,1333.23483057526,1499.40328494487,1516.02013038183,1532.63697581879,1549.25382125576,1565.87066669272,1582.48751212968,1599.10435756664,1615.72120300360,1629.56857420107;0.0867774973746314,0.143611758844978,0.126561480403874,0.112352915036288,0.228863151050498,0.211812872609394,0.200446020315325,0.183395741874221,0.228863151050498,0.214654585682912,0.243071716418085,0.167766319969876,0.253491331020982,0.234546577197533,0.211102444341015,0.197604307241808,0.180554028800703,0.163503750359600,0.146453471918496,0.251596855638637,0.234546577197533,0.217496298756429,0.200446020315325,0.124667005021530,0.183395741874221,0.166345463433117,0.149295184992013,0.317903494020709,0.300853215579604,0.284750174829673,0.308431117108984,0.292801695204639,0.272436084844431,0.257280281785672,0.240230003344568,0.223179724903464,0.202340495697670,0.189079168021256,0.297774693083294,0.280013986373811,0.319797969403053,0.291380838667880,0.274330560226776,0.262963707932706,0.247807904873947,0.237388290271050,0.224600581440222,0.208971159535877,0.237388290271050,0.218443536447602,0.198172649856511,0.179133172263945,0.203287733388843,0.185527026679359,0.181974885337462,0.169187176506634,0.156873086521392,0.143611758844978,0.132244906550909,0.136981095006771,0.125614242712702,0.119930816565667,0.108090345426012,0.109511201962770,0.0953026365951835,0.0754106450805621,0.0905664481393211,0.0725689320070448,0.0791995958452518,0.0763578827717346,0.0507824651100788,0.0299432359042848,0.0128929574631806,0.0697272189335276,0.0640437927864928,0.0597812231762167,0.0441518012718714,0.0517297028012509,0.0469935143453886,0.0460462766542160,0.0422573258895267,0.0289959982131123,0.0289959982131123,0.0128929574631806,0.0147874328455253,0.0233125720660774,0.0280487605219397,0.0280487605219397,0.0242598097572500,0.0242598097572500,0.0242598097572500,0.0195236213013881,0.0185763836102155,0.0147874328455253,0.00815676900731832,0.00720953131614577,0.00720953131614577,0.0109984820808360,0.0109984820808360,0.0109984820808360,0.0128929574631806,0.0128929574631806,0.0128929574631806,0.0109984820808360,0.0109984820808360,0.00720953131614577,0.00720953131614577,0.00720953131614577,0.00720953131614577,0.00720953131614577,0.00720953131614577,0.00720953131614577,0.00720953131614577,0.00720953131614577,0.00720953131614577,0.00720953131614577,0.00720953131614577];
    
    XY = XY';
    XY = sortrows(XY, 1);
    [~, i] = unique(XY(:,1));
    XY = XY(i,:);
    
    X = XY(:,1);
    Y = XY(:,2);
    
    res = 100;
    x = linspace(350, 750, res);
    y = interp1(X, Y, x);
        
    figure(1)
    clf
    set(gcf,'color','white')
    plot(x, y, 'k')
    xlim([300 800])
    ylim([0 max(ylim)])
%     set(gca,'xscale','log')
%     xlim([300 4000])
    
    grid on
    grid minor

% end


















































