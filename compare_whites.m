% function compare_whites

    clear
    clc
    
    %%
    
    addpath('C:\Users\Daniel\Desktop\PAINTERS_COPILOT\')
    [Observer, ~, ~] = prepare_studio(0);

    %%
    
    lambda = 400 : 10 : 700; % nm
    
    R = [
            0.419228762388229 0.412163406610489 0.409130930900574 0.425339162349701 0.424358606338501
            0.634373009204865 0.627739369869232 0.591209232807159 0.642791271209717 0.663179457187653
            0.720395624637604 0.717211246490479 0.64924556016922  0.725625097751617 0.763601779937744
            0.739171206951141 0.741389691829681 0.658585131168366 0.73939436674118  0.782959520816803
            0.753207564353943 0.757933616638184 0.666840553283691 0.748039960861206 0.792492032051086
            0.764961957931519 0.769857347011566 0.671728551387787 0.755958676338196 0.798655271530151
            0.77691262960434  0.782563984394074 0.675674378871918 0.76786881685257  0.806752443313599
            0.789044797420502 0.79179173707962  0.681109309196472 0.782943725585938 0.813937425613403
            0.799004256725311 0.794144511222839 0.681506991386414 0.798078536987305 0.819054126739502
            0.805269002914429 0.793686032295227 0.683256447315216 0.808837294578552 0.821136355400085
            0.810006201267242 0.788945138454437 0.687536597251892 0.814324378967285 0.819934129714966
            0.811531007289887 0.778692841529846 0.692454755306244 0.81391966342926  0.815295517444611
            0.813628256320953 0.766140222549439 0.699285447597504 0.813791930675507 0.809975504875183
            0.814394891262054 0.756407797336578 0.702472567558289 0.813949465751648 0.80669641494751
            0.81684023141861  0.756307721138001 0.704170644283295 0.816722512245178 0.80588686466217
            0.817512035369873 0.75555819272995  0.705635488033295 0.819503128528595 0.804408073425293
            0.820939362049103 0.756702780723572 0.708229780197144 0.828202545642853 0.804543197154999
            0.820352733135223 0.751272618770599 0.707691013813019 0.83239758014679  0.800227224826813
            0.816370844841003 0.747993946075439 0.704858779907227 0.832266330718994 0.795513868331909
            0.81968104839325  0.753948330879211 0.707220911979675 0.838854432106018 0.79919821023941
            0.825120508670807 0.765593647956848 0.707483410835266 0.846544325351715 0.806909918785095
            0.826633453369141 0.771570682525635 0.704519927501678 0.848898887634277 0.815259099006653
            0.825987160205841 0.772713422775269 0.701591312885284 0.84886634349823  0.822117805480957
            0.829502999782562 0.782662749290466 0.702956855297089 0.853306651115418 0.835116505622864
            0.83211362361908  0.79537159204483  0.70319938659668  0.858000040054321 0.85026341676712
            0.837509572505951 0.810527443885803 0.707020819187164 0.866359233856201 0.868975758552551
            0.843369543552399 0.822378993034363 0.712005853652954 0.874155819416046 0.883574068546295
            0.848154604434967 0.831530213356018 0.712859988212585 0.878752112388611 0.891256630420685
            0.850810289382935 0.83135986328125  0.712110817432404 0.880052924156189 0.891719043254852
            0.853663027286529 0.834702908992767 0.711335122585297 0.881402015686035 0.894192814826965
            0.855384826660156 0.837604761123657 0.708732485771179 0.881288349628449 0.897950232028961
        ];
    
    labels = {
                'Winsor & Newton titanium white'
                'White 92 bright printer paper'
                'Spectro 1 white calibration tile'
                'Strathmore watercolor 400 series'
                'Strathmore bristol vellum 100 lb'
             };
         
    %%
    
    Rr = zeros(length(Observer.lambda), size(R,2)); % R, resampled
    for f = 1 : size(R,2)
        Rr(:,f) = resample_and_extrapolate(lambda, R(:,f), Observer.lambda);
    end
    R = Rr;
    lambda = Observer.lambda;
    
    %%
    
    figure(20)
        clf
        hold on
        set(gcf,'color','white')

        lw = 2; % line width

        plot(lambda, R(:,1), 'b', 'LineWidth', 2)
        plot(lambda, R(:,2), 'r', 'LineWidth', 2)
        plot(lambda, R(:,3), 'g', 'LineWidth', 2)
        plot(lambda, R(:,4), 'c', 'LineWidth', 2)
        plot(lambda, R(:,5), 'm', 'LineWidth', 2)
        
        plot(Observer.lambda, Observer.responses(:,2), ':', 'LineWidth', lw, 'Color', zeros(1,3)+0.5)
        [val, ind] = max(Observer.responses(:,2));
        text(Observer.lambda(ind), val, ['     y\_bar'], 'HorizontalAlignment','left','VerticalAlignment','top')

        grid on
        grid minor
        axis([min(lambda) max(lambda) 0 1])

        title('Opaque Diffuse Whites: Reflectance Spectra')
        xlabel('Wavelength, nm')
        ylabel('Reflectance, Diffuse, ~')

        legend(labels, 'location','east','FontSize', 8)
    
    %%
    
    B = zeros(size(R,2),1); % brightness
    for f = 1 : size(R,2)
        B(f) = dot(Observer.responses(:,2), R(:,f));
    end
    
    figure(21)
    clf
    set(gcf,'color','white')
    bar(B, 'FaceColor',zeros(1,3)+0.5, 'EdgeColor','none')
    for f = 1:size(R,2)
        text(f, B(f), num2str(round(B(f)*100)/100), 'VerticalAlignment','top','HorizontalAlignment','center')
        text(f, 0, [' ' labels{f}], 'Rotation', 90)
    end
    grid on
    grid minor
    title('Opaque Diffuse Whites: Overall Brightnesses')
    xlabel('Material Index, Arbitrary Order')
    ylabel('Brightness, ~, Dot Product of Reflectance and y\_bar')
    

% end



















































